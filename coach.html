<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Coach Mode - Infinity</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/lottie-web@5.12.2/build/player/lottie.min.js"></script>
    <style>
        body {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            min-height: 100vh;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            position: relative;
        }
        
        .glass-morphism {
            background: rgba(139, 92, 246, 0.08);
            backdrop-filter: blur(60px) saturate(400%);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 
                0 25px 80px rgba(0, 0, 0, 0.95),
                0 0 40px rgba(139, 92, 246, 0.2),
                0 0 80px rgba(139, 92, 246, 0.05);
        }
        
        .cyber-card {
            background: rgba(100, 0, 255, 0.12);
            border: 1px solid rgba(139, 92, 246, 0.5);
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(20px);
        }
        
        .cyber-card:hover {
            transform: none;
            background: rgba(100, 0, 255, 0.25);
            border-color: rgba(139, 92, 246, 0.9);
        }
        
        .quantum-btn {
            background: #8b5cf6;
            border: none;
            color: white;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);
        }
        
        .quantum-btn:hover {
            transform: none;
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.4);
            background: #00d4ff;
        }
        
        .neon-purple {
            box-shadow: 
                0 0 10px rgba(139, 92, 246, 0.6),
                0 0 20px rgba(139, 92, 246, 0.4),
                0 0 30px rgba(139, 92, 246, 0.2);
        }
        
        .coach-pulse {
            animation: coachPulse 2s ease-in-out infinite;
        }
        
        @keyframes coachPulse {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; }
        }
        
        .typing-indicator {
            animation: typing 1.5s ease-in-out infinite;
        }
        
        @keyframes typing {
            0%, 100% { opacity: 0.4; }
            50% { opacity: 1; }
        }
        
        .lesson-card {
            background: rgba(0, 212, 255, 0.08);
            border: 1px solid rgba(0, 212, 255, 0.3);
        }
        
        .lesson-card:hover {
            background: rgba(0, 212, 255, 0.15);
            border-color: rgba(0, 212, 255, 0.6);
        }
        
        .progress-bar {
            background: linear-gradient(90deg, #ff4444 0%, #ffaa00 25%, #ffff00 50%, #00ff00 75%, #00ffff 100%);
            height: 6px;
            border-radius: 3px;
            position: relative;
            overflow: hidden;
        }
        
        .progress-fill {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
            transition: width 0.5s ease;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        const AICoach = () => {
            const [messages, setMessages] = useState([]);
            const [inputMessage, setInputMessage] = useState('');
            const [isTyping, setIsTyping] = useState(false);
            const [userLevel, setUserLevel] = useState('beginner');
            const [currentLesson, setCurrentLesson] = useState(null);
            const [userProgress, setUserProgress] = useState({
                lessons_completed: 0,
                total_lessons: 12,
                xp: 0,
                level: 1,
                streak: 0
            });
            const [showLessons, setShowLessons] = useState(false);
            const messagesEndRef = useRef(null);

            const scrollToBottom = () => {
                messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
            };

            useEffect(() => {
                scrollToBottom();
            }, [messages]);

            const lessons = [
                {
                    id: 1,
                    title: "Card Grading Basics",
                    description: "Learn the fundamentals of card condition assessment",
                    difficulty: "Beginner",
                    duration: "5 min",
                    xp: 50,
                    completed: false
                },
                {
                    id: 2,
                    title: "Market Analysis Fundamentals",
                    description: "Understand how to analyze card market trends",
                    difficulty: "Beginner",
                    duration: "7 min",
                    xp: 75,
                    completed: false
                },
                {
                    id: 3,
                    title: "Investment Strategies",
                    description: "Master different approaches to card investing",
                    difficulty: "Intermediate",
                    duration: "10 min",
                    xp: 100,
                    completed: false
                },
                {
                    id: 4,
                    title: "Risk Management",
                    description: "Learn how to protect your investments",
                    difficulty: "Intermediate",
                    duration: "8 min",
                    xp: 90,
                    completed: false
                },
                {
                    id: 5,
                    title: "Portfolio Diversification",
                    description: "Build a balanced card portfolio",
                    difficulty: "Advanced",
                    duration: "12 min",
                    xp: 150,
                    completed: false
                },
                {
                    id: 6,
                    title: "Advanced Market Timing",
                    description: "Master the art of buying and selling at the right time",
                    difficulty: "Advanced",
                    duration: "15 min",
                    xp: 200,
                    completed: false
                }
            ];

            const getCoachResponse = (message) => {
                const responses = {
                    beginner: {
                        greeting: "Welcome to AI Coach Mode! I'm here to help you become a card investing expert. What would you like to learn about first?",
                        grading: "Card grading is all about condition assessment. The main factors are surface, centering, corners, and edges. Each gets a subgrade from 1-10, and the overall grade is usually the lowest subgrade. Want me to explain any specific aspect?",
                        market: "Market analysis involves looking at recent sales, price trends, and demand patterns. Start by checking recent eBay sales and comparing similar cards. I can help you identify undervalued opportunities!",
                        investment: "For beginners, I recommend starting with established players and popular sets. Focus on cards in good condition (PSA 8+) and avoid high-risk prospects until you're more experienced. What's your budget range?",
                        portfolio: "A good portfolio should be diversified across different players, sports, and eras. Don't put all your money in one card or player. I can help you build a balanced portfolio based on your goals!"
                    },
                    intermediate: {
                        greeting: "Great to see you back! You're making good progress. Ready to dive deeper into advanced strategies?",
                        grading: "You understand the basics. Now let's focus on spotting subtle condition issues that can affect grades. Look for print lines, surface scratches, and corner dings that might not be obvious at first glance.",
                        market: "At your level, you should be analyzing market cycles and seasonal trends. Look for patterns in player performance, rookie breakouts, and set popularity. Timing is everything!",
                        investment: "You're ready for more sophisticated strategies. Consider arbitrage opportunities, grading flips, and prospect investing. What specific strategy interests you most?",
                        portfolio: "Time to optimize your portfolio allocation. Consider risk-adjusted returns, correlation analysis, and rebalancing strategies. How's your current diversification looking?"
                    },
                    advanced: {
                        greeting: "Welcome back, expert! Ready to tackle the most challenging aspects of card investing?",
                        grading: "You know the grading standards inside and out. Let's discuss advanced techniques like cross-grading strategies, timing submissions, and maximizing value through condition improvement.",
                        market: "You're analyzing complex market dynamics. Let's dive into advanced topics like market manipulation detection, insider information analysis, and predictive modeling techniques.",
                        investment: "You're ready for the most sophisticated strategies. Let's explore advanced arbitrage, market making, and institutional-level investment approaches. What's your next big move?",
                        portfolio: "Your portfolio management skills are top-tier. Let's discuss advanced topics like derivatives, hedging strategies, and alternative investment vehicles in the card market."
                    }
                };

                const levelResponses = responses[userLevel] || responses.beginner;
                
                if (message.toLowerCase().includes('grading') || message.toLowerCase().includes('grade')) {
                    return levelResponses.grading;
                } else if (message.toLowerCase().includes('market') || message.toLowerCase().includes('price')) {
                    return levelResponses.market;
                } else if (message.toLowerCase().includes('invest') || message.toLowerCase().includes('buy') || message.toLowerCase().includes('sell')) {
                    return levelResponses.investment;
                } else if (message.toLowerCase().includes('portfolio') || message.toLowerCase().includes('holdings')) {
                    return levelResponses.portfolio;
                } else if (message.toLowerCase().includes('hello') || message.toLowerCase().includes('hi')) {
                    return levelResponses.greeting;
                } else {
                    return `That's a great question! As your AI coach, I'd recommend focusing on the fundamentals first. Based on your ${userLevel} level, let me suggest some key areas to explore. What specific aspect of card investing would you like to dive deeper into?`;
                }
            };

            const sendMessage = () => {
                if (!inputMessage.trim()) return;

                const userMessage = {
                    id: Date.now(),
                    text: inputMessage,
                    sender: 'user',
                    timestamp: new Date()
                };

                setMessages(prev => [...prev, userMessage]);
                setInputMessage('');
                setIsTyping(true);

                setTimeout(() => {
                    const coachResponse = {
                        id: Date.now() + 1,
                        text: getCoachResponse(inputMessage),
                        sender: 'coach',
                        timestamp: new Date(),
                        explanation: "This advice is based on your current skill level and market conditions. Remember, investing always carries risk!",
                        tips: [
                            "Always do your own research",
                            "Start with small investments",
                            "Diversify your portfolio",
                            "Keep learning and adapting"
                        ]
                    };

                    setMessages(prev => [...prev, coachResponse]);
                    setIsTyping(false);
                }, 1500);
            };

            const startLesson = (lesson) => {
                setCurrentLesson(lesson);
                setShowLessons(false);
                
                const lessonMessage = {
                    id: Date.now(),
                    text: `Let's start the lesson: "${lesson.title}"! This is a ${lesson.difficulty} level lesson that will take about ${lesson.duration}. You'll earn ${lesson.xp} XP upon completion. Ready to begin?`,
                    sender: 'coach',
                    timestamp: new Date(),
                    isLesson: true
                };

                setMessages(prev => [...prev, lessonMessage]);
            };

            const completeLesson = () => {
                if (currentLesson) {
                    setUserProgress(prev => ({
                        ...prev,
                        lessons_completed: prev.lessons_completed + 1,
                        xp: prev.xp + currentLesson.xp,
                        level: Math.floor((prev.xp + currentLesson.xp) / 100) + 1,
                        streak: prev.streak + 1
                    }));

                    const completionMessage = {
                        id: Date.now(),
                        text: `🎉 Congratulations! You've completed "${currentLesson.title}" and earned ${currentLesson.xp} XP! Your total XP is now ${userProgress.xp + currentLesson.xp}. Keep up the great work!`,
                        sender: 'coach',
                        timestamp: new Date(),
                        isCompletion: true
                    };

                    setMessages(prev => [...prev, completionMessage]);
                    setCurrentLesson(null);
                }
            };

            const goHome = () => {
                window.location.href = 'index.html';
            };

            return (
                <div className="min-h-screen">
                    {/* Header */}
                    <header className="glass-morphism border-b border-purple-400/20 sticky top-0 z-50">
                        <div className="container mx-auto px-6 py-4">
                            <div className="flex items-center justify-between">
                                <div className="flex items-center gap-4">
                                    <button onClick={goHome} className="text-purple-400 hover:text-white transition-colors">
                                        ← Back to Home
                                    </button>
                                    <h1 className="text-3xl font-bold text-purple-400">🎓 AI Coach Mode</h1>
                                </div>
                                <div className="flex items-center gap-4">
                                    <div className="text-sm text-gray-400">
                                        Level {userProgress.level} • {userProgress.xp} XP
                                    </div>
                                    <button
                                        onClick={() => setShowLessons(!showLessons)}
                                        className="quantum-btn px-4 py-2 rounded-lg text-sm"
                                    >
                                        📚 Lessons
                                    </button>
                                </div>
                            </div>
                        </div>
                    </header>

                    <main className="container mx-auto px-6 py-8">
                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
                            {/* Chat Interface */}
                            <div className="lg:col-span-2 space-y-6">
                                {/* Progress Overview */}
                                <div className="glass-morphism p-6 rounded-lg neon-purple">
                                    <h2 className="text-xl font-bold text-purple-400 mb-4">Your Learning Progress</h2>
                                    <div className="grid grid-cols-3 gap-4 mb-4">
                                        <div className="text-center">
                                            <div className="text-2xl font-bold text-cyan-400">{userProgress.lessons_completed}</div>
                                            <div className="text-sm text-gray-400">Lessons Completed</div>
                                        </div>
                                        <div className="text-center">
                                            <div className="text-2xl font-bold text-green-400">{userProgress.xp}</div>
                                            <div className="text-sm text-gray-400">Total XP</div>
                                        </div>
                                        <div className="text-center">
                                            <div className="text-2xl font-bold text-yellow-400">{userProgress.streak}</div>
                                            <div className="text-sm text-gray-400">Day Streak</div>
                                        </div>
                                    </div>
                                    <div className="w-full bg-gray-700 rounded-full h-2">
                                        <div className="progress-bar">
                                            <div className="progress-fill" style={{width: `${(userProgress.lessons_completed / userProgress.total_lessons) * 100}%`}}></div>
                                        </div>
                                    </div>
                                    <div className="text-center text-sm text-gray-400 mt-2">
                                        {userProgress.lessons_completed} of {userProgress.total_lessons} lessons completed
                                    </div>
                                </div>

                                {/* Chat Messages */}
                                <div className="glass-morphism p-6 rounded-lg h-96 overflow-y-auto">
                                    <div className="space-y-4">
                                        {messages.length === 0 ? (
                                            <div className="text-center text-gray-400">
                                                <div className="text-4xl mb-4 coach-pulse">🎓</div>
                                                <p>Welcome to AI Coach Mode! Ask me anything about card investing.</p>
                                            </div>
                                        ) : (
                                            messages.map((message) => (
                                                <div key={message.id} className={`flex ${message.sender === 'user' ? 'justify-end' : 'justify-start'}`}>
                                                    <div className={`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${
                                                        message.sender === 'user' 
                                                            ? 'bg-purple-600 text-white' 
                                                            : 'bg-gray-700 text-gray-100'
                                                    }`}>
                                                        <div className="text-sm">{message.text}</div>
                                                        {message.explanation && (
                                                            <div className="text-xs text-gray-400 mt-2 italic">
                                                                {message.explanation}
                                                            </div>
                                                        )}
                                                        {message.tips && (
                                                            <div className="mt-2">
                                                                <div className="text-xs font-bold text-cyan-400 mb-1">Pro Tips:</div>
                                                                {message.tips.map((tip, idx) => (
                                                                    <div key={idx} className="text-xs text-gray-300">• {tip}</div>
                                                                ))}
                                                            </div>
                                                        )}
                                                        <div className="text-xs text-gray-400 mt-1">
                                                            {message.timestamp.toLocaleTimeString()}
                                                        </div>
                                                    </div>
                                                </div>
                                            ))
                                        )}
                                        {isTyping && (
                                            <div className="flex justify-start">
                                                <div className="bg-gray-700 text-gray-100 px-4 py-2 rounded-lg">
                                                    <div className="typing-indicator">Coach is typing...</div>
                                                </div>
                                            </div>
                                        )}
                                        <div ref={messagesEndRef} />
                                    </div>
                                </div>

                                {/* Input Area */}
                                <div className="glass-morphism p-4 rounded-lg">
                                    <div className="flex gap-2">
                                        <input
                                            type="text"
                                            value={inputMessage}
                                            onChange={(e) => setInputMessage(e.target.value)}
                                            onKeyPress={(e) => e.key === 'Enter' && sendMessage()}
                                            placeholder="Ask your AI coach anything about card investing..."
                                            className="flex-1 bg-gray-800 text-white px-4 py-2 rounded-lg border border-gray-600 focus:border-purple-400 focus:outline-none"
                                        />
                                        <button
                                            onClick={sendMessage}
                                            disabled={!inputMessage.trim()}
                                            className="quantum-btn px-6 py-2 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed"
                                        >
                                            Send
                                        </button>
                                    </div>
                                </div>
                            </div>

                            {/* Sidebar */}
                            <div className="space-y-6">
                                {/* Current Lesson */}
                                {currentLesson && (
                                    <div className="glass-morphism p-6 rounded-lg neon-purple">
                                        <h3 className="text-lg font-bold text-purple-400 mb-4">Current Lesson</h3>
                                        <div className="lesson-card p-4 rounded-lg mb-4">
                                            <div className="font-bold text-white mb-2">{currentLesson.title}</div>
                                            <div className="text-sm text-gray-300 mb-2">{currentLesson.description}</div>
                                            <div className="flex justify-between text-xs text-gray-400">
                                                <span>{currentLesson.difficulty}</span>
                                                <span>{currentLesson.duration}</span>
                                                <span>{currentLesson.xp} XP</span>
                                            </div>
                                        </div>
                                        <button
                                            onClick={completeLesson}
                                            className="quantum-btn w-full py-2 rounded-lg"
                                        >
                                            Complete Lesson
                                        </button>
                                    </div>
                                )}

                                {/* Quick Tips */}
                                <div className="glass-morphism p-6 rounded-lg">
                                    <h3 className="text-lg font-bold text-purple-400 mb-4">Quick Tips</h3>
                                    <div className="space-y-3 text-sm">
                                        <div className="cyber-card p-3 rounded-lg">
                                            <div className="font-bold text-cyan-400 mb-1">Grading</div>
                                            <div className="text-gray-300">Always check corners, edges, centering, and surface</div>
                                        </div>
                                        <div className="cyber-card p-3 rounded-lg">
                                            <div className="font-bold text-green-400 mb-1">Market</div>
                                            <div className="text-gray-300">Research recent sales before making decisions</div>
                                        </div>
                                        <div className="cyber-card p-3 rounded-lg">
                                            <div className="font-bold text-yellow-400 mb-1">Investment</div>
                                            <div className="text-gray-300">Diversify across different players and sports</div>
                                        </div>
                                        <div className="cyber-card p-3 rounded-lg">
                                            <div className="font-bold text-purple-400 mb-1">Portfolio</div>
                                            <div className="text-gray-300">Regularly review and rebalance your holdings</div>
                                        </div>
                                    </div>
                                </div>

                                {/* Level Badges */}
                                <div className="glass-morphism p-6 rounded-lg">
                                    <h3 className="text-lg font-bold text-purple-400 mb-4">Achievements</h3>
                                    <div className="space-y-2">
                                        <div className="flex items-center gap-2">
                                            <div className="text-2xl">🥉</div>
                                            <div className="text-sm text-gray-300">Beginner Investor</div>
                                        </div>
                                        <div className="flex items-center gap-2">
                                            <div className="text-2xl">🥈</div>
                                            <div className="text-sm text-gray-300">Intermediate Trader</div>
                                        </div>
                                        <div className="flex items-center gap-2">
                                            <div className="text-2xl">🥇</div>
                                            <div className="text-sm text-gray-300">Expert Investor</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* Lessons Modal */}
                        {showLessons && (
                            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                                <div className="glass-morphism p-6 rounded-lg max-w-2xl w-full mx-4 max-h-96 overflow-y-auto">
                                    <div className="flex justify-between items-center mb-4">
                                        <h2 className="text-2xl font-bold text-purple-400">Learning Modules</h2>
                                        <button
                                            onClick={() => setShowLessons(false)}
                                            className="text-gray-400 hover:text-white"
                                        >
                                            ✕
                                        </button>
                                    </div>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        {lessons.map((lesson) => (
                                            <div key={lesson.id} className="lesson-card p-4 rounded-lg">
                                                <div className="font-bold text-white mb-2">{lesson.title}</div>
                                                <div className="text-sm text-gray-300 mb-3">{lesson.description}</div>
                                                <div className="flex justify-between items-center mb-3">
                                                    <span className="text-xs text-gray-400">{lesson.difficulty}</span>
                                                    <span className="text-xs text-gray-400">{lesson.duration}</span>
                                                    <span className="text-xs text-cyan-400">{lesson.xp} XP</span>
                                                </div>
                                                <button
                                                    onClick={() => startLesson(lesson)}
                                                    className="quantum-btn w-full py-2 rounded-lg text-sm"
                                                >
                                                    Start Lesson
                                                </button>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        )}
                    </main>
                </div>
            );
        };

        ReactDOM.render(<AICoach />, document.getElementById('root'));
    </script>
</body>
</html>
